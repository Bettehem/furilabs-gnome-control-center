From f7249bc2cd9c8ed3a1c0844683b6c9a547169b6b Mon Sep 17 00:00:00 2001
From: Robert Ancell <robert.ancell@canonical.com>
Date: Wed, 17 Jun 2020 11:15:33 +1200
Subject: [PATCH] sound: Stop non-interactive profile changes from triggering
 changed events

Fixes https://gitlab.gnome.org/GNOME/gnome-control-center/-/issues/1033
---
 panels/sound/cc-profile-combo-box.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/panels/sound/cc-profile-combo-box.c b/panels/sound/cc-profile-combo-box.c
index da7b9b048..a328b98c0 100644
--- a/panels/sound/cc-profile-combo-box.c
+++ b/panels/sound/cc-profile-combo-box.c
@@ -119,7 +119,11 @@ cc_profile_combo_box_set_device (CcProfileComboBox *self,
                           -1);
 
       if (g_strcmp0 (gvc_mixer_ui_device_get_active_profile (device), profile->profile) == 0)
-        gtk_combo_box_set_active_iter (GTK_COMBO_BOX (self), &iter);
+        {
+          g_signal_handlers_block_by_func(self, profile_changed_cb, self);
+          gtk_combo_box_set_active_iter (GTK_COMBO_BOX (self), &iter);
+          g_signal_handlers_unblock_by_func(self, profile_changed_cb, self);
+        }
     }
 }
 
-- 

